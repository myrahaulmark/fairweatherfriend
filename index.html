<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1">
    <title>Fair Weather Friend</title>

    <!-- Loading third-party fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|" rel="stylesheet" type="text/css">
    <link href="fonts/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- Loading main CSS file -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="site-content">
        <div class="site-header">
            <div class="container">
                <a href="index.html" class="branding">
                    <img src="images/logo.png" alt="" class="logo">
                    <div class="logo-type">
                        <h1 class="site-title">Fair Weather Friend</h1>
                        <small class="site-description">Your source of fair and not so fair weather information.</small>
                    </div>
                </a>
            </div>
        </div>

        <div class="hero" data-bg-image="images/banner.png">
            <div class="container">
                <form class="find-location" onsubmit="event.preventDefault(); searchWeather();">
                    <input type="text" id="location-input" placeholder="Enter city, ZIP, or lat/lon...">
                    <input type="submit" value="Find">
                </form>
            </div>
        </div>

        <div class="forecast-content">
			<h2 id="location-name">Fetching location...</h2>
			<div class="location" id="city">Fetching...</div>
			<div class="degree">
				<div class="num"><span id="temperature">--</span><sup>°F</sup></div>
				<div class="forecast-icon">
					<img id="weather-icon" src="images/icons/default.svg" alt="Weather icon" width="90">
				</div>
			</div>
			<p id="weather-description">Fetching weather...</p>
			<span><strong>Humidity:</strong> <span id="humidity">--</span>%</span><br>
			<span><strong>Precipitation Probability:</strong> <span id="precipitationProbability">--</span>%</span><br>
			<span><strong>Cloud Cover:</strong> <span id="cloudCover">--</span>%</span><br>
			<span><strong>Cloud Base:</strong> <span id="cloudBase">--</span> mi</span><br>
			<span><strong>Cloud Ceiling:</strong> <span id="cloudCeiling">--</span> mi</span><br>
			<span><strong>Dew Point:</strong> <span id="dewPoint">--</span>°F</span><br>
			<span><strong>Pressure:</strong> <span id="pressureSurfaceLevel">--</span> inHg</span><br>
			<span><strong>Rain Intensity:</strong> <span id="rainIntensity">--</span> in/hr</span><br>
			<span><strong>Wind Speed:</strong> <span id="windSpeed">--</span> mph</span><br>
			<span><strong>Wind Gust:</strong> <span id="windGust">--</span> mph</span><br>
			<span><strong>Wind Direction:</strong> <span id="windDirection">--</span>°</span><br>
			<span><strong>Visibility:</strong> <span id="visibility">--</span> mi</span><br>
		</div>
		
                    </div>
                </div>
            </div>
        </div>

        <footer class="site-footer">
            <div class="container">
                <p class="colophon">© 2024 Fair Weather Friend. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <script>
        async function fetchWeather(location = "Chicago") {  
    const apiUrl = `https://weatherfunctiontest.azurewebsites.net/api/weather?location=${encodeURIComponent(location)}&code=rwV2V1QfdaVniXLLDhIQxw8IfPYjgBoH`;

    try {
        const response = await fetch(apiUrl);
        if (!response.ok) {
            throw new Error(`HTTP Error ${response.status}`);
        }

        const data = await response.json();
        console.log("✅ API Response:", data);

        if (!data.data || !data.location || !data.data.values) {
            throw new Error("❌ Invalid API response format");
        }

        const locationName = data.location.name;
        const weather = data.data.values;
        const date = new Date(data.data.time);

        function updateElement(id, value, unit = "") {
            const el = document.getElementById(id);
            if (!el) {
                console.warn(`⚠️ Warning: Element with id '${id}' is missing in HTML.`);
                return;
            }
            el.textContent = value !== undefined ? `${value}${unit}` : "--";
        }

        updateElement('location-name', locationName);
        updateElement('city', locationName);
        updateElement('temperature', weather.temperature, "°F");
        updateElement('humidity', weather.humidity, "%");
        updateElement('precipitationProbability', weather.precipitationProbability, "%");
        updateElement('cloudCover', weather.cloudCover, "%");
        updateElement('cloudBase', weather.cloudBase, " mi");
        updateElement('cloudCeiling', weather.cloudCeiling, " mi");
        updateElement('dewPoint', weather.dewPoint, "°F");
        updateElement('pressureSurfaceLevel', weather.pressureSurfaceLevel, " inHg");
        updateElement('rainIntensity', weather.rainIntensity, " in/hr");
        updateElement('windSpeed', weather.windSpeed, " mph");
        updateElement('windGust', weather.windGust, " mph");
        updateElement('windDirection', weather.windDirection, "°");
        updateElement('visibility', weather.visibility, " mi");

        const weatherIconEl = document.getElementById('weather-icon');
        const weatherDescriptionEl = document.getElementById('weather-description');

        if (weatherIconEl) weatherIconEl.src = getWeatherIcon(weather.weatherCode);
        if (weatherDescriptionEl) weatherDescriptionEl.textContent = getWeatherDescription(weather.weatherCode);

    } catch (error) {
        console.error("❌ Error fetching weather data:", error);
        const weatherDescriptionEl = document.getElementById('weather-description');
        if (weatherDescriptionEl) weatherDescriptionEl.textContent = "Failed to load weather data.";
    }
}

    </script>
</body>
</html>
